# snowbattle-pvp

## 開始処理

1. ゲーム中ではないかどうかの確認 (`snowbattle:start/check-not-playing`)
   ゲーム中だったら tellraw でエラー表示して終了
2. プレイヤー数が足りているかの確認（2 人以上） (`snowbattle:start/check-player-count`)
   プレイヤー数が足りなかったら tellraw でエラー表示して終了
3. 他のシステムが稼働しているかの確認（これは後回し） (`snowbattle:start/check-other-pvp-running`)
4. 参加者を SnowBattle チームに追加、参加者を示すためにサイドバーに SnowBattle オブジェクトを表示
5. 開始 3 秒カウントダウン
6. ゲーム開始告知
7. エリア内に雪ブロックの設置　※ここから並行してゲーム中処理を行う
8. 参加者をアドベンチャーモードに
9. 参加者のインベントリを保存、アイテムをクリアしたあと シャベル / 雪玉 x30 /釣り竿 / 焼肉 x5 を配布
10. エリア上空に spreadplayers する -> y68 (PvP エリア)にテレポートさせる
11. 参加者ヒール
12. エフェクトの削除

## ゲーム中処理（以下を並行してすべて実施）

- 参加者がエリア場外にいるか: tellraw & ゲーム参加者から自動除外
- 参加者以外がエリア場内にいるか: 観客エリアにテレポート、ゲーム中なことを tellraw
- 参加者がクリエイティブモードか: tellraw & ゲームモードをアドベンチャーモードに変更
- 参加者がサバイバルモードか: tellraw & ゲームモードをアドベンチャーモードに変更
- 参加者が残り一人になったか: ゲーム終了処理を開始

## 脱落処理（落ちた時点で特定位置に移動させて処理 or その他アプローチ）

0. 脱落処理エリアに参加者以外がいる: 観客エリアにテレポート
1. SnowBattle チームメンバーから削除
2. Chat コマンドか tellraw で脱落したことを告知
3. 観客エリアにテレポート
4. インベントリを復元
5. クリエイティブモードに変更

## ゲーム終了処理

1. tellraw でゲーム終了告知
2. 残った勝者を告知
3. 勝者のインベントリを復元
4. 勝者をクリエイティブモードに変更
5. ゲーム中状態の解除
6. 「ゲーム中処理」の停止
7. SnowBattle の広告
8. SnowBattle オブジェクト/チームの削除
9. プレイ数カウンタを更新（これはまあどうしようかねえ）
